# üì° ZIC Protocol v1 (ZIC-P1) ‚Äî –ü–æ–ª–Ω—ã–π –ì–∞–π–¥

ZIC-P1 ‚Äî —ç—Ç–æ –ø—Ä–∏–∫–ª–∞–¥–Ω–æ–π WebSocket-–ø—Ä–æ—Ç–æ–∫–æ–ª –¥–ª—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–º–ø—å—é—Ç–µ—Ä–∞–º–∏ –≤ —à–∫–æ–ª—å–Ω–æ–º –∫–ª–∞—Å—Å–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∏ –≤ —Ä–∞–º–∫–∞—Ö –ø—Ä–æ–µ–∫—Ç–∞ **Zentas Informatic Class (ZIC)**.

–ü—Ä–æ—Ç–æ–∫–æ–ª –ø–æ–∑–≤–æ–ª—è–µ—Ç:
- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –ü–ö
- –í—ã–ø–æ–ª–Ω—è—Ç—å –∫–æ–º–∞–Ω–¥—ã (REBOOT, SYS_INFO –∏ –¥—Ä.)
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –Ω–∞–¥—ë–∂–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
- –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å –∏ –ø—Ä–∏–Ω–∏–º–∞—Ç—å –¥–∞–Ω–Ω—ã–µ
- –ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∞—Ç—É—Å –∏ –ª–æ–≥–∏–∫—É —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

## üìö –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–û–±—â–∏–π —Ñ–æ—Ä–º–∞—Ç —Å–æ–æ–±—â–µ–Ω–∏—è](#–æ–±—â–∏–π-—Ñ–æ—Ä–º–∞—Ç-—Å–æ–æ–±—â–µ–Ω–∏—è)
2. [–≠—Ç–∞–ø –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ (INIT)](#—ç—Ç–∞–ø-–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏-init)
3. [–ö–æ–º–∞–Ω–¥—ã –∏ –æ—Ç–≤–µ—Ç—ã](#–∫–æ–º–∞–Ω–¥—ã-–∏-–æ—Ç–≤–µ—Ç—ã)
4. [–ü–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è (PING/PONG)](#–ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–µ-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è-pingpong)
5. [–û—à–∏–±–∫–∏ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞](#–æ—à–∏–±–∫–∏-–∏-–æ–±—Ä–∞–±–æ—Ç–∫–∞)
6. [–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å](#–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)
7. [–•—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏ —Ç—É–Ω–Ω–µ–ª–µ–π](#—Ö—Ä–∞–Ω–µ–Ω–∏–µ-—Å–æ—Å—Ç–æ—è–Ω–∏—è-–∏-—Ç—É–Ω–Ω–µ–ª–µ–π)
8. [–í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ](#–≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ)
9. [–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∞—É–¥–∏—Ç](#–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ-–∏-–∞—É–¥–∏—Ç)
10. [–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ](#–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ)
11. [Best Practices](#best-practices)
12. [Security Considerations](#security-considerations)

## üì¶ –û–±—â–∏–π —Ñ–æ—Ä–º–∞—Ç —Å–æ–æ–±—â–µ–Ω–∏—è

–í—Å–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç —á–µ—Ä–µ–∑ WebSocket. –°–æ–æ–±—â–µ–Ω–∏—è ‚Äî —ç—Ç–æ JSON-–æ–±—ä–µ–∫—Ç—ã —Å–æ —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π:

```json
{
  "version": "1.0",             // –í–µ—Ä—Å–∏—è –ø—Ä–æ—Ç–æ–∫–æ–ª–∞
  "type": "init" | "command" | "response" | "ping" | "pong" | "error" | "notification",
  "id": "<uuid>",               // –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID —Å–æ–æ–±—â–µ–Ω–∏—è
  "from": "client" | "server",  // –û—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å
  "timestamp": "ISO8601",       // –í—Ä–µ–º–µ–Ω–Ω–∞—è –º–µ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
  "payload": { ... }            // –û—Å–Ω–æ–≤–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
}
```

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|----------|
| version | string | –í–µ—Ä—Å–∏—è –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "1.0") |
| type | string | –¢–∏–ø —Å–æ–æ–±—â–µ–Ω–∏—è (init/command/response/ping/pong/error/notification) |
| id | string | UUID v4 –¥–ª—è —É–Ω–∏–∫–∞–ª—å–Ω–æ–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏—è |
| from | string | –û—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å (client/server) |
| timestamp | string | ISO8601 timestamp —Å –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞–º–∏ |
| payload | object | –û—Å–Ω–æ–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è |

## üöÄ –≠—Ç–∞–ø –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ (INIT)

### ‚ñ∂Ô∏è –ö–ª–∏–µ–Ω—Ç ‚Üí –°–µ—Ä–≤–µ—Ä

```json
{
  "version": "1.0",             // –í–µ—Ä—Å–∏—è –ø—Ä–æ—Ç–æ–∫–æ–ª–∞
  "type": "init",               // –¢–∏–ø —Å–æ–æ–±—â–µ–Ω–∏—è
  "id": "msg-uuid-1",           // –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID —Å–æ–æ–±—â–µ–Ω–∏—è
  "from": "client",             // –û—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å
  "timestamp": "2024-03-31T10:00:00.000Z", // –í—Ä–µ–º–µ–Ω–Ω–∞—è –º–µ—Ç–∫–∞
  "payload": {
    "computer_id": "uuid-1234", // ID –∫–æ–º–ø—å—é—Ç–µ—Ä–∞
    "jwt": "<jwt-—Å-–ø–æ–¥–ø–∏—Å—å—é>",  // JWT —Ç–æ–∫–µ–Ω –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
    "client_version": "1.0.0",  // –í–µ—Ä—Å–∏—è –∫–ª–∏–µ–Ω—Ç–∞
    "os": "Windows 11",         // –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞
    "local_ip": "192.168.0.10", // –õ–æ–∫–∞–ª—å–Ω—ã–π IP
    "public_ip": "12.34.56.78"  // –ü—É–±–ª–∏—á–Ω—ã–π IP
  }
}
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ JWT

```json
{
  "sub": "computer-uuid",       // Subject (ID –∫–æ–º–ø—å—é—Ç–µ—Ä–∞)
  "iss": "zentas",             // Issuer (–∏–∑–¥–∞—Ç–µ–ª—å —Ç–æ–∫–µ–Ω–∞)
  "aud": "zic-protocol",       // Audience (–ø–æ–ª—É—á–∞—Ç–µ–ª—å)
  "iat": 1711872000,           // Issued At (–≤—Ä–µ–º—è –≤—ã–ø—É—Å–∫–∞)
  "exp": 1711875600            // Expiration (–≤—Ä–µ–º—è –∏—Å—Ç–µ—á–µ–Ω–∏—è)
}
```

### ‚úÖ –°–µ—Ä–≤–µ—Ä ‚Üí –ö–ª–∏–µ–Ω—Ç

```json
{
  "version": "1.0",             // –í–µ—Ä—Å–∏—è –ø—Ä–æ—Ç–æ–∫–æ–ª–∞
  "type": "response",           // –¢–∏–ø —Å–æ–æ–±—â–µ–Ω–∏—è
  "id": "msg-uuid-1",           // –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID —Å–æ–æ–±—â–µ–Ω–∏—è
  "from": "server",             // –û—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å
  "timestamp": "2024-03-31T10:00:00.001Z", // –í—Ä–µ–º–µ–Ω–Ω–∞—è –º–µ—Ç–∫–∞
  "payload": {
    "status": "ok",             // –°—Ç–∞—Ç—É—Å –æ—Ç–≤–µ—Ç–∞
    "tunnel_id": "abc-123-xyz", // ID —Ç—É–Ω–Ω–µ–ª—è
    "message": "–£—Å–ø–µ—à–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω", // –°–æ–æ–±—â–µ–Ω–∏–µ
    "server_time": "2024-03-31T10:00:00.001Z", // –í—Ä–µ–º—è —Å–µ—Ä–≤–µ—Ä–∞
    "ping_interval": 30000,     // –ò–Ω—Ç–µ—Ä–≤–∞–ª –º–µ–∂–¥—É ping –≤ –º—Å
    "pong_timeout": 60000,      // –¢–∞–π–º–∞—É—Ç –æ–∂–∏–¥–∞–Ω–∏—è pong –≤ –º—Å
    "reconnect_attempts": 3,    // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
    "reconnect_delay": 5000     // –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –ø–æ–ø—ã—Ç–∫–∞–º–∏ –≤ –º—Å
  }
}
```

## üì° –ö–æ–º–∞–Ω–¥—ã –∏ –æ—Ç–≤–µ—Ç—ã

### –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| REBOOT | –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ |
| SYS_INFO | –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∏—Å—Ç–µ–º–µ |
| SCREENSHOT | –°–¥–µ–ª–∞—Ç—å —Å–∫—Ä–∏–Ω—à–æ—Ç |
| FILE_TRANSFER | –ü–µ—Ä–µ–¥–∞—á–∞ —Ñ–∞–π–ª–æ–≤ |
| REMOTE_SHELL | –£–¥–∞–ª–µ–Ω–Ω—ã–π shell |
| UPDATE | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞ |
| LOCK_SCREEN | –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —ç–∫—Ä–∞–Ω–∞ |
| SEND_MESSAGE | –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è |

### –ü—Ä–∏–º–µ—Ä—ã –∫–æ–º–∞–Ω–¥

#### REBOOT
```json
{
  "version": "1.0",             // –í–µ—Ä—Å–∏—è –ø—Ä–æ—Ç–æ–∫–æ–ª–∞
  "type": "command",            // –¢–∏–ø —Å–æ–æ–±—â–µ–Ω–∏—è
  "id": "msg-uuid-2",           // –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID —Å–æ–æ–±—â–µ–Ω–∏—è
  "from": "server",             // –û—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å
  "timestamp": "2024-03-31T10:01:00.000Z", // –í—Ä–µ–º–µ–Ω–Ω–∞—è –º–µ—Ç–∫–∞
  "payload": {
    "command": "REBOOT",        // –ö–æ–º–∞–Ω–¥–∞
    "args": {
      "force": false,           // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞
      "timeout": 30,            // –ó–∞–¥–µ—Ä–∂–∫–∞ –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–æ–π –≤ —Å–µ–∫
      "message": "–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ 30 —Å–µ–∫—É–Ω–¥" // –°–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
    }
  }
}
```

#### SCREENSHOT
```json
{
  "version": "1.0",             // –í–µ—Ä—Å–∏—è –ø—Ä–æ—Ç–æ–∫–æ–ª–∞
  "type": "command",            // –¢–∏–ø —Å–æ–æ–±—â–µ–Ω–∏—è
  "id": "msg-uuid-3",           // –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID —Å–æ–æ–±—â–µ–Ω–∏—è
  "from": "server",             // –û—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å
  "timestamp": "2024-03-31T10:02:00.000Z", // –í—Ä–µ–º–µ–Ω–Ω–∞—è –º–µ—Ç–∫–∞
  "payload": {
    "command": "SCREENSHOT",    // –ö–æ–º–∞–Ω–¥–∞
    "args": {
      "format": "png",          // –§–æ—Ä–º–∞—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
      "quality": 90,            // –ö–∞—á–µ—Å—Ç–≤–æ (1-100)
      "region": {               // –û–±–ª–∞—Å—Ç—å —Å–∫—Ä–∏–Ω—à–æ—Ç–∞
        "x": 0,                 // X –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞
        "y": 0,                 // Y –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞
        "width": 1920,          // –®–∏—Ä–∏–Ω–∞
        "height": 1080          // –í—ã—Å–æ—Ç–∞
      }
    }
  }
}
```

## üìä –ü–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è (PING/PONG)

### –¢–∞–π–º–∞—É—Ç—ã –∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|----------|
| ping_interval | 30000ms | –ò–Ω—Ç–µ—Ä–≤–∞–ª –º–µ–∂–¥—É ping |
| pong_timeout | 60000ms | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è pong |
| reconnect_attempts | 3 | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è |
| reconnect_delay | 5000ms | –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –ø–æ–ø—ã—Ç–∫–∞–º–∏ |

### –ü—Ä–∏–º–µ—Ä—ã

#### Ping
```json
{
  "version": "1.0",             // –í–µ—Ä—Å–∏—è –ø—Ä–æ—Ç–æ–∫–æ–ª–∞
  "type": "ping",               // –¢–∏–ø —Å–æ–æ–±—â–µ–Ω–∏—è
  "id": "ping-uuid-1",          // –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID —Å–æ–æ–±—â–µ–Ω–∏—è
  "from": "server",             // –û—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å
  "timestamp": "2024-03-31T10:00:00.000Z", // –í—Ä–µ–º–µ–Ω–Ω–∞—è –º–µ—Ç–∫–∞
  "payload": {
    "timestamp": "2024-03-31T10:00:00.000Z", // –í—Ä–µ–º—è –æ—Ç–ø—Ä–∞–≤–∫–∏
    "sequence": 1               // –ü–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä
  }
}
```

#### Pong
```json
{
  "version": "1.0",             // –í–µ—Ä—Å–∏—è –ø—Ä–æ—Ç–æ–∫–æ–ª–∞
  "type": "pong",               // –¢–∏–ø —Å–æ–æ–±—â–µ–Ω–∏—è
  "id": "ping-uuid-1",          // –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID —Å–æ–æ–±—â–µ–Ω–∏—è
  "from": "client",             // –û—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å
  "timestamp": "2024-03-31T10:00:00.001Z", // –í—Ä–µ–º–µ–Ω–Ω–∞—è –º–µ—Ç–∫–∞
  "payload": {
    "timestamp": "2024-03-31T10:00:00.000Z", // –í—Ä–µ–º—è –ø–æ–ª—É—á–µ–Ω–∏—è ping
    "sequence": 1,              // –ü–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä
    "latency": 1                // –ó–∞–¥–µ—Ä–∂–∫–∞ –≤ –º—Å
  }
}
```

## ‚ùå –û—à–∏–±–∫–∏ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞

### –ö–æ–¥—ã –æ—à–∏–±–æ–∫

| –ö–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏—á–∏–Ω—ã | –î–µ–π—Å—Ç–≤–∏—è |
|-----|----------|---------|----------|
| unauthorized | –ù–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø | –ù–µ–≤–µ—Ä–Ω—ã–π JWT | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–æ–∫–µ–Ω |
| invalid_command | –ù–µ–≤–µ—Ä–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞ | –ù–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–∞—è –∫–æ–º–∞–Ω–¥–∞ | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é |
| timeout | –¢–∞–π–º–∞—É—Ç –æ–ø–µ—Ä–∞—Ü–∏–∏ | –°–ª–∏—à–∫–æ–º –¥–æ–ª–≥–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ | –£–≤–µ–ª–∏—á–∏—Ç—å —Ç–∞–π–º–∞—É—Ç |
| rate_limit | –ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ | –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤ | –£–º–µ–Ω—å—à–∏—Ç—å —á–∞—Å—Ç–æ—Ç—É |
| internal_error | –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ | –ü—Ä–æ–±–ª–µ–º—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ | –û–±—Ä–∞—Ç–∏—Ç—å—Å—è –∫ –∞–¥–º–∏–Ω—É |

### –ü—Ä–∏–º–µ—Ä –æ—à–∏–±–∫–∏
```json
{
  "version": "1.0",             // –í–µ—Ä—Å–∏—è –ø—Ä–æ—Ç–æ–∫–æ–ª–∞
  "type": "error",              // –¢–∏–ø —Å–æ–æ–±—â–µ–Ω–∏—è
  "id": "msg-id",               // –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID —Å–æ–æ–±—â–µ–Ω–∏—è
  "from": "server",             // –û—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å
  "timestamp": "2024-03-31T10:00:00.000Z", // –í—Ä–µ–º–µ–Ω–Ω–∞—è –º–µ—Ç–∫–∞
  "payload": {
    "code": "unauthorized",     // –ö–æ–¥ –æ—à–∏–±–∫–∏
    "message": "Invalid JWT token", // –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
    "details": {                // –î–µ—Ç–∞–ª–∏ –æ—à–∏–±–∫–∏
      "reason": "expired",      // –ü—Ä–∏—á–∏–Ω–∞
      "expired_at": "2024-03-31T09:55:00Z" // –í—Ä–µ–º—è –∏—Å—Ç–µ—á–µ–Ω–∏—è
    }
  }
}
```

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

1. –í—Å–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ WSS (WebSocket Secure)
2. JWT —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º `jwt_secret` –∏–∑ –ë–î
   - –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ —Å–µ–∫—Ä–µ—Ç–∞: 32 –±–∞–π—Ç–∞
   - –†–æ—Ç–∞—Ü–∏—è –∫–∞–∂–¥—ã–µ 30 –¥–Ω–µ–π
   - –•—Ä–∞–Ω–µ–Ω–∏–µ –≤ HashiCorp Vault
3. –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–∞ —ç—Ç–∞–ø–µ INIT
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ JWT –ø–æ–¥–ø–∏—Å–∏
   - –í–∞–ª–∏–¥–∞—Ü–∏—è claims (iss, aud, exp)
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ computer_id –≤ –ë–î
4. Rate-limit –∏ –∑–∞—â–∏—Ç–∞ –æ—Ç DDoS
   - –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ IP
   - –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ computer_id
   - Circuit breaker –¥–ª—è –∫–æ–º–∞–Ω–¥
5. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–π
   - –ö–ª–∏–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–µ —Å—Ç–∞—Ä—à–µ —Å–µ—Ä–≤–µ—Ä–∞
   - –ü—Ä–æ—Ç–æ–∫–æ–ª –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–æ–≤–º–µ—Å—Ç–∏–º
6. –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
   - TLS 1.3 –¥–ª—è WebSocket
   - –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ payload (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
   - –ü–æ–¥–ø–∏—Å–∏ —Å–æ–æ–±—â–µ–Ω–∏–π (HMAC)
7. –ê—É–¥–∏—Ç –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
   - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π
   - –ê–ª–µ—Ä—Ç—ã –Ω–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
   - –ú–µ—Ç—Ä–∏–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### Rate Limiting

| –û–ø–µ—Ä–∞—Ü–∏—è | –õ–∏–º–∏—Ç | –ü–µ—Ä–∏–æ–¥ | –î–µ–π—Å—Ç–≤–∏–µ –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ |
|----------|-------|--------|------------------------|
| INIT | 5 | 1 –º–∏–Ω—É—Ç–∞ | –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ IP –Ω–∞ 5 –º–∏–Ω—É—Ç |
| COMMAND | 10 | 1 —Å–µ–∫—É–Ω–¥–∞ | –û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ —Å rate_limit |
| PING | 2 | 1 —Å–µ–∫—É–Ω–¥–∞ | –†–∞–∑—Ä—ã–≤ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è |

### –ó–∞—â–∏—Ç–∞ –æ—Ç –∞—Ç–∞–∫

1. DDoS Protection
   - Cloudflare –∏–ª–∏ –∞–Ω–∞–ª–æ–≥–∏
   - Rate limiting –Ω–∞ —É—Ä–æ–≤–Ω–µ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
   - IP reputation checking

2. Man-in-the-Middle
   - –°—Ç—Ä–æ–≥–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
   - HSTS
   - Certificate Pinning

3. Replay Attacks
   - Timestamp –≤ –∫–∞–∂–¥–æ–º —Å–æ–æ–±—â–µ–Ω–∏–∏
   - –û–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–µ —Ç–æ–∫–µ–Ω—ã –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ sequence numbers

4. Injection Attacks
   - –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤—Ö–æ–¥—è—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö
   - –≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤
   - –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ payload

## üóÑÔ∏è –•—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏ —Ç—É–Ω–Ω–µ–ª–µ–π

### Redis —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

```redis
# –ê–∫—Ç–∏–≤–Ω—ã–µ —Ç—É–Ω–Ω–µ–ª–∏
pc:{computer_id} -> {
  "tunnel_id": "abc-123",
  "status": "online",
  "last_seen": "2024-03-31T10:00:00Z",
  "ip": "192.168.0.10",
  "os": "Windows 11"
}

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
stats:{computer_id} -> {
  "commands_sent": 100,
  "errors": 5,
  "last_error": "timeout"
}
```

## üß¨ –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –≤–µ—Ä—Å–∏–∏

| –í–µ—Ä—Å–∏—è | –°—Ç–∞—Ç—É—Å | –î–∞—Ç–∞ —Ä–µ–ª–∏–∑–∞ |
|--------|--------|-------------|
| 1.0 | –ê–∫—Ç–∏–≤–Ω–∞—è | 2024-03-31 |
| 1.1 | –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ | 2024-04-30 |

### –ü–ª–∞–Ω –º–∏–≥—Ä–∞—Ü–∏–∏

1. –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å—Ç–∞—Ä—ã—Ö –≤–µ—Ä—Å–∏–π 6 –º–µ—Å—è—Ü–µ–≤
2. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–æ–≤
3. –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 12 –º–µ—Å—è—Ü–µ–≤

## üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∞—É–¥–∏—Ç

### –õ–æ–≥–∏—Ä—É–µ–º—ã–µ —Å–æ–±—ã—Ç–∏—è

1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
2. –ö–æ–º–∞–Ω–¥—ã –∏ –æ—Ç–≤–µ—Ç—ã
3. –û—à–∏–±–∫–∏
4. –†–∞–∑—Ä—ã–≤ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
5. –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞

### –§–æ—Ä–º–∞—Ç –ª–æ–≥–∞

```json
{
  "timestamp": "2024-03-31T10:00:00.000Z", // –í—Ä–µ–º–µ–Ω–Ω–∞—è –º–µ—Ç–∫–∞
  "event": "command",           // –¢–∏–ø —Å–æ–±—ã—Ç–∏—è
  "computer_id": "uuid-123",    // ID –∫–æ–º–ø—å—é—Ç–µ—Ä–∞
  "command": "REBOOT",          // –ö–æ–º–∞–Ω–¥–∞
  "status": "success",          // –°—Ç–∞—Ç—É—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
  "duration_ms": 150,           // –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤ –º—Å
  "user": "teacher-1",          // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
  "ip": "192.168.0.100"        // IP –∞–¥—Ä–µ—Å
}
```

## üìà –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

1. Redis Cluster –¥–ª—è —Å–æ—Å—Ç–æ—è–Ω–∏—è
2. Load Balancer –¥–ª—è WebSocket
3. –®–∞—Ä–¥–∏–Ω–≥ –ø–æ classroom_id
4. –†–µ–ø–ª–∏–∫–∞—Ü–∏—è –ª–æ–≥–æ–≤

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

1. Prometheus –º–µ—Ç—Ä–∏–∫–∏
2. Grafana –¥–∞—à–±–æ—Ä–¥—ã
3. –ê–ª–µ—Ä—Ç—ã –Ω–∞:
   - –í—ã—Å–æ–∫—É—é –ª–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å
   - –û—à–∏–±–∫–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
   - –†–∞–∑—Ä—ã–≤—ã —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π

## üí° Best Practices

### –ö–ª–∏–µ–Ω—Ç

1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å exponential backoff –¥–ª—è –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
2. –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å JWT
3. –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –≤—Ö–æ–¥—è—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
4. –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤–∞–∂–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è
5. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å offline —Ä–µ–∂–∏–º

### –°–µ—Ä–≤–µ—Ä

1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å connection pooling
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å circuit breaker
3. –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏
4. –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–µ–ø–ª–æ–π
5. –í–µ—Å—Ç–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

## üîí Security Considerations

1. –í—Å–µ —Å–µ–∫—Ä–µ—Ç—ã –≤ vault
2. –†–µ–≥—É–ª—è—Ä–Ω—ã–π —Ä–æ—Ç–∞—Ç –∫–ª—é—á–µ–π
3. –ê—É–¥–∏—Ç –¥–æ—Å—Ç—É–ø–∞
4. –ó–∞—â–∏—Ç–∞ –æ—Ç DDoS
5. –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
6. –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –ª–æ–≥–æ–≤
